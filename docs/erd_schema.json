{
  "database": {
    "name": "atlaspm",
    "type": "MongoDB",
    "version": "5.0+",
    "description": "Multi-tenant enterprise portfolio and project management platform"
  },
  "collections": {
    "tenants": {
      "description": "Tenant organizations with subscription and configuration data",
      "fields": {
        "_id": {"type": "string", "primary_key": true, "description": "UUID tenant identifier"},
        "name": {"type": "string", "required": true, "max_length": 200, "description": "Organization name"},
        "code": {"type": "string", "required": true, "unique": true, "max_length": 50, "description": "Unique tenant code"},
        "domain": {"type": "string", "required": true, "unique": true, "description": "Organization domain"},
        "status": {"type": "enum", "values": ["active", "suspended", "trial", "cancelled"], "default": "trial"},
        "plan": {"type": "enum", "values": ["starter", "professional", "enterprise"], "default": "starter"},
        "admin_email": {"type": "string", "required": true, "description": "Primary admin email"},
        "admin_name": {"type": "string", "required": true, "description": "Primary admin name"},
        "phone": {"type": "string", "description": "Contact phone number"},
        "address": {"type": "object", "description": "Organization address"},
        "subscription_start": {"type": "datetime", "description": "Subscription start date"},
        "subscription_end": {"type": "datetime", "description": "Subscription end date"},
        "max_users": {"type": "integer", "default": 10, "description": "Maximum allowed users"},
        "max_projects": {"type": "integer", "default": 50, "description": "Maximum allowed projects"},
        "settings": {"type": "object", "description": "Tenant-specific configuration"},
        "sso_enabled": {"type": "boolean", "default": false},
        "sso_config": {"type": "object", "description": "SSO provider configuration"},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "description": "User ID who created"},
        "updated_by": {"type": "string", "description": "User ID who last updated"}
      },
      "indexes": [
        {"fields": ["code"], "unique": true},
        {"fields": ["domain"], "unique": true},
        {"fields": ["status"]},
        {"fields": ["created_at"]}
      ]
    },
    "organizations": {
      "description": "Organizational units within a tenant for hierarchy management",
      "fields": {
        "_id": {"type": "string", "primary_key": true, "description": "UUID organization identifier"},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "code": {"type": "string", "required": true, "max_length": 50},
        "description": {"type": "string"},
        "parent_org_id": {"type": "string", "foreign_key": "organizations._id", "description": "Parent organization for hierarchy"},
        "org_level": {"type": "integer", "description": "Hierarchy level (0=root)"},
        "org_path": {"type": "string", "description": "Hierarchical path for queries"},
        "manager_id": {"type": "string", "foreign_key": "users._id"},
        "cost_center": {"type": "string", "description": "Financial cost center code"},
        "budget_amount": {"type": "decimal", "default": 0},
        "settings": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "code"], "unique": true},
        {"fields": ["tenant_id", "parent_org_id"]},
        {"fields": ["tenant_id", "org_level"]},
        {"fields": ["tenant_id", "manager_id"]}
      ]
    },
    "users": {
      "description": "System users with role-based access control",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "username": {"type": "string", "required": true, "min_length": 3, "max_length": 50},
        "email": {"type": "string", "required": true, "format": "email"},
        "full_name": {"type": "string", "required": true},
        "hashed_password": {"type": "string", "required": true},
        "role": {"type": "enum", "values": ["admin", "pmo_admin", "portfolio_manager", "project_manager", "resource", "finance", "viewer"], "required": true},
        "status": {"type": "enum", "values": ["active", "inactive", "suspended", "pending_verification"], "default": "pending_verification"},
        "job_title": {"type": "string"},
        "department": {"type": "string"},
        "phone": {"type": "string"},
        "avatar_url": {"type": "string"},
        "manager_id": {"type": "string", "foreign_key": "users._id"},
        "permissions": {"type": "array", "items": {"type": "string"}},
        "portfolio_access": {"type": "array", "items": {"type": "string", "foreign_key": "portfolios._id"}},
        "project_access": {"type": "array", "items": {"type": "string", "foreign_key": "projects._id"}},
        "hourly_rate": {"type": "decimal"},
        "cost_center": {"type": "string"},
        "last_login": {"type": "datetime"},
        "failed_login_attempts": {"type": "integer", "default": 0},
        "locked_until": {"type": "datetime"},
        "password_reset_token": {"type": "string"},
        "password_reset_expires": {"type": "datetime"},
        "email_verification_token": {"type": "string"},
        "sso_provider_id": {"type": "string"},
        "sso_external_id": {"type": "string"},
        "preferences": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "username"], "unique": true},
        {"fields": ["tenant_id", "email"], "unique": true},
        {"fields": ["tenant_id", "role"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "org_id"]},
        {"fields": ["sso_external_id"]},
        {"fields": ["created_at"]}
      ]
    },
    "portfolios": {
      "description": "Strategic portfolios containing related projects",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "code": {"type": "string", "required": true, "max_length": 50},
        "description": {"type": "string"},
        "portfolio_type": {"type": "enum", "values": ["strategic", "operational", "innovation", "maintenance"], "required": true},
        "status": {"type": "enum", "values": ["draft", "active", "on_hold", "completed", "cancelled"], "default": "draft"},
        "health_status": {"type": "enum", "values": ["green", "yellow", "red"], "default": "green"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "portfolio_manager_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "sponsors": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "stakeholders": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "strategic_objectives": {"type": "array", "items": {"type": "object"}},
        "business_case_url": {"type": "string"},
        "start_date": {"type": "date"},
        "end_date": {"type": "date"},
        "financial_metrics": {"type": "object"},
        "risk_metrics": {"type": "object"},
        "project_ids": {"type": "array", "items": {"type": "string", "foreign_key": "projects._id"}},
        "settings": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "code"], "unique": true},
        {"fields": ["tenant_id", "portfolio_manager_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "org_id"]},
        {"fields": ["created_at"]}
      ]
    },
    "projects": {
      "description": "Individual projects within portfolios",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "portfolio_id": {"type": "string", "foreign_key": "portfolios._id"},
        "parent_project_id": {"type": "string", "foreign_key": "projects._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "code": {"type": "string", "required": true, "max_length": 50},
        "description": {"type": "string"},
        "project_type": {"type": "enum", "values": ["software_development", "infrastructure", "research", "marketing", "process_improvement", "compliance", "other"], "required": true},
        "methodology": {"type": "enum", "values": ["waterfall", "agile", "scrum", "kanban", "hybrid", "lean"], "default": "agile"},
        "status": {"type": "enum", "values": ["draft", "active", "on_hold", "completed", "cancelled"], "default": "draft"},
        "health_status": {"type": "enum", "values": ["green", "yellow", "red"], "default": "green"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "project_manager_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "sponsor_id": {"type": "string", "foreign_key": "users._id"},
        "team_members": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "planned_start_date": {"type": "date"},
        "planned_end_date": {"type": "date"},
        "actual_start_date": {"type": "date"},
        "actual_end_date": {"type": "date"},
        "percent_complete": {"type": "number", "default": 0, "min": 0, "max": 100},
        "milestones": {"type": "array", "items": {"type": "object"}},
        "financials": {"type": "object"},
        "resource_allocations": {"type": "array", "items": {"type": "object"}},
        "risk_score": {"type": "number", "default": 0, "min": 0, "max": 1},
        "open_issues_count": {"type": "integer", "default": 0},
        "open_risks_count": {"type": "integer", "default": 0},
        "document_urls": {"type": "array", "items": {"type": "string"}},
        "custom_fields": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "code"], "unique": true},
        {"fields": ["tenant_id", "portfolio_id"]},
        {"fields": ["tenant_id", "project_manager_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "org_id"]},
        {"fields": ["planned_start_date", "planned_end_date"]},
        {"fields": ["created_at"]}
      ]
    },
    "tasks": {
      "description": "Individual work items within projects",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "project_id": {"type": "string", "required": true, "foreign_key": "projects._id"},
        "parent_task_id": {"type": "string", "foreign_key": "tasks._id"},
        "milestone_id": {"type": "string"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string"},
        "task_type": {"type": "enum", "values": ["story", "task", "bug", "epic", "subtask"], "default": "task"},
        "status": {"type": "enum", "values": ["backlog", "todo", "in_progress", "review", "done", "cancelled"], "default": "todo"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "assignee_id": {"type": "string", "foreign_key": "users._id"},
        "reporter_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "estimated_hours": {"type": "number", "default": 0},
        "actual_hours": {"type": "number", "default": 0},
        "remaining_hours": {"type": "number", "default": 0},
        "story_points": {"type": "integer"},
        "planned_start_date": {"type": "date"},
        "planned_end_date": {"type": "date"},
        "actual_start_date": {"type": "date"},
        "actual_end_date": {"type": "date"},
        "due_date": {"type": "date"},
        "dependencies": {"type": "array", "items": {"type": "string", "foreign_key": "tasks._id"}},
        "blockers": {"type": "array", "items": {"type": "string", "foreign_key": "tasks._id"}},
        "labels": {"type": "array", "items": {"type": "string"}},
        "sprint_id": {"type": "string"},
        "epic_id": {"type": "string", "foreign_key": "tasks._id"},
        "acceptance_criteria": {"type": "string"},
        "custom_fields": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "project_id"]},
        {"fields": ["tenant_id", "assignee_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "due_date"]},
        {"fields": ["parent_task_id"]},
        {"fields": ["created_at"]}
      ]
    },
    "assignments": {
      "description": "Task assignments to users with allocation details",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "task_id": {"type": "string", "required": true, "foreign_key": "tasks._id"},
        "user_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "role": {"type": "string", "description": "Role in this assignment"},
        "allocation_percentage": {"type": "number", "min": 0, "max": 100},
        "hourly_rate": {"type": "decimal"},
        "start_date": {"type": "date"},
        "end_date": {"type": "date"},
        "status": {"type": "enum", "values": ["assigned", "accepted", "in_progress", "completed", "rejected"], "default": "assigned"},
        "estimated_hours": {"type": "number", "default": 0},
        "actual_hours": {"type": "number", "default": 0},
        "notes": {"type": "string"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "task_id", "user_id"], "unique": true},
        {"fields": ["tenant_id", "user_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["start_date", "end_date"]},
        {"fields": ["created_at"]}
      ]
    }
  }
}