{
  "database_info": {
    "name": "atlaspm",
    "type": "MongoDB",
    "version": "5.0+",
    "description": "Multi-tenant enterprise portfolio and project management platform",
    "architecture": "Multi-tenant with tenant_id isolation",
    "scaling_strategy": "Horizontal sharding with tenant-based distribution"
  },
  "collections": {
    "tenants": {
      "description": "Root tenant organizations with subscription and configuration data",
      "category": "Core",
      "estimated_size": "Small (100s)",
      "growth_rate": "Low",
      "fields": {
        "_id": {"type": "string", "primary_key": true, "description": "UUID tenant identifier"},
        "name": {"type": "string", "required": true, "max_length": 200, "description": "Organization name"},
        "code": {"type": "string", "required": true, "unique": true, "max_length": 50, "description": "Unique tenant code"},
        "domain": {"type": "string", "required": true, "unique": true, "description": "Organization domain"},
        "status": {"type": "enum", "values": ["active", "suspended", "trial", "cancelled"], "default": "trial"},
        "plan": {"type": "enum", "values": ["starter", "professional", "enterprise"], "default": "starter"},
        "admin_email": {"type": "string", "required": true, "description": "Primary admin email"},
        "admin_name": {"type": "string", "required": true, "description": "Primary admin name"},
        "phone": {"type": "string", "description": "Contact phone number"},
        "address": {"type": "object", "description": "Organization address"},
        "subscription_start": {"type": "datetime", "description": "Subscription start date"},
        "subscription_end": {"type": "datetime", "description": "Subscription end date"},
        "max_users": {"type": "integer", "default": 10, "description": "Maximum allowed users"},
        "max_projects": {"type": "integer", "default": 50, "description": "Maximum allowed projects"},
        "settings": {"type": "object", "description": "Tenant-specific configuration"},
        "sso_enabled": {"type": "boolean", "default": false},
        "sso_config": {"type": "object", "description": "SSO provider configuration"},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "description": "User ID who created"},
        "updated_by": {"type": "string", "description": "User ID who last updated"}
      },
      "indexes": [
        {"fields": ["code"], "unique": true},
        {"fields": ["domain"], "unique": true},
        {"fields": ["status"]},
        {"fields": ["created_at"]}
      ]
    },
    "organizations": {
      "description": "Organizational units within tenants for hierarchy management",
      "category": "Core", 
      "estimated_size": "Medium (1000s)",
      "growth_rate": "Medium",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "code": {"type": "string", "required": true, "max_length": 50},
        "description": {"type": "string"},
        "parent_org_id": {"type": "string", "foreign_key": "organizations._id", "description": "Parent organization"},
        "org_level": {"type": "integer", "description": "Hierarchy level (0=root)"},
        "org_path": {"type": "string", "description": "Hierarchical path"},
        "manager_id": {"type": "string", "foreign_key": "users._id"},
        "cost_center": {"type": "string", "description": "Financial cost center code"},
        "budget_amount": {"type": "decimal", "default": 0},
        "settings": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "code"], "unique": true},
        {"fields": ["tenant_id", "parent_org_id"]},
        {"fields": ["tenant_id", "org_level"]},
        {"fields": ["tenant_id", "manager_id"]}
      ]
    },
    "users": {
      "description": "System users with role-based access control",
      "category": "Core",
      "estimated_size": "Large (10,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "username": {"type": "string", "required": true, "min_length": 3, "max_length": 50},
        "email": {"type": "string", "required": true, "format": "email"},
        "full_name": {"type": "string", "required": true},
        "hashed_password": {"type": "string", "required": true},
        "role": {"type": "enum", "values": ["admin", "pmo_admin", "portfolio_manager", "project_manager", "resource", "finance", "viewer"], "required": true},
        "status": {"type": "enum", "values": ["active", "inactive", "suspended", "pending_verification"], "default": "pending_verification"},
        "job_title": {"type": "string"},
        "department": {"type": "string"},
        "phone": {"type": "string"},
        "avatar_url": {"type": "string"},
        "manager_id": {"type": "string", "foreign_key": "users._id"},
        "permissions": {"type": "array", "items": {"type": "string"}},
        "portfolio_access": {"type": "array", "items": {"type": "string", "foreign_key": "portfolios._id"}},
        "project_access": {"type": "array", "items": {"type": "string", "foreign_key": "projects._id"}},
        "hourly_rate": {"type": "decimal"},
        "cost_center": {"type": "string"},
        "last_login": {"type": "datetime"},
        "failed_login_attempts": {"type": "integer", "default": 0},
        "locked_until": {"type": "datetime"},
        "password_reset_token": {"type": "string"},
        "password_reset_expires": {"type": "datetime"},
        "email_verification_token": {"type": "string"},
        "sso_provider_id": {"type": "string"},
        "sso_external_id": {"type": "string"},
        "preferences": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "username"], "unique": true},
        {"fields": ["tenant_id", "email"], "unique": true},
        {"fields": ["tenant_id", "role"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "org_id"]},
        {"fields": ["sso_external_id"]},
        {"fields": ["created_at"]}
      ]
    },
    "portfolios": {
      "description": "Strategic portfolios containing related projects",
      "category": "Business",
      "estimated_size": "Medium (1000s)",
      "growth_rate": "Medium",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "code": {"type": "string", "required": true, "max_length": 50},
        "description": {"type": "string"},
        "portfolio_type": {"type": "enum", "values": ["strategic", "operational", "innovation", "maintenance"], "required": true},
        "status": {"type": "enum", "values": ["draft", "active", "on_hold", "completed", "cancelled"], "default": "draft"},
        "health_status": {"type": "enum", "values": ["green", "yellow", "red"], "default": "green"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "portfolio_manager_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "sponsors": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "stakeholders": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "strategic_objectives": {"type": "array", "items": {"type": "object"}},
        "business_case_url": {"type": "string"},
        "start_date": {"type": "date"},
        "end_date": {"type": "date"},
        "financial_metrics": {"type": "object"},
        "risk_metrics": {"type": "object"},
        "project_ids": {"type": "array", "items": {"type": "string", "foreign_key": "projects._id"}},
        "settings": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "code"], "unique": true},
        {"fields": ["tenant_id", "portfolio_manager_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "org_id"]},
        {"fields": ["created_at"]}
      ]
    },
    "projects": {
      "description": "Individual projects within portfolios",
      "category": "Business",
      "estimated_size": "Large (10,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "portfolio_id": {"type": "string", "foreign_key": "portfolios._id"},
        "parent_project_id": {"type": "string", "foreign_key": "projects._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "code": {"type": "string", "required": true, "max_length": 50},
        "description": {"type": "string"},
        "project_type": {"type": "enum", "values": ["software_development", "infrastructure", "research", "marketing", "process_improvement", "compliance", "other"], "required": true},
        "methodology": {"type": "enum", "values": ["waterfall", "agile", "scrum", "kanban", "hybrid", "lean"], "default": "agile"},
        "status": {"type": "enum", "values": ["draft", "active", "on_hold", "completed", "cancelled"], "default": "draft"},
        "health_status": {"type": "enum", "values": ["green", "yellow", "red"], "default": "green"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "project_manager_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "sponsor_id": {"type": "string", "foreign_key": "users._id"},
        "team_members": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "planned_start_date": {"type": "date"},
        "planned_end_date": {"type": "date"},
        "actual_start_date": {"type": "date"},
        "actual_end_date": {"type": "date"},
        "percent_complete": {"type": "number", "default": 0, "min": 0, "max": 100},
        "milestones": {"type": "array", "items": {"type": "object"}},
        "financials": {"type": "object"},
        "resource_allocations": {"type": "array", "items": {"type": "object"}},
        "risk_score": {"type": "number", "default": 0, "min": 0, "max": 1},
        "open_issues_count": {"type": "integer", "default": 0},
        "open_risks_count": {"type": "integer", "default": 0},
        "document_urls": {"type": "array", "items": {"type": "string"}},
        "custom_fields": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "code"], "unique": true},
        {"fields": ["tenant_id", "portfolio_id"]},
        {"fields": ["tenant_id", "project_manager_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "org_id"]},
        {"fields": ["planned_start_date", "planned_end_date"]},
        {"fields": ["created_at"]}
      ]
    },
    "tasks": {
      "description": "Individual work items within projects",
      "category": "Operations",
      "estimated_size": "Very Large (100,000s)",
      "growth_rate": "Very High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "project_id": {"type": "string", "required": true, "foreign_key": "projects._id"},
        "parent_task_id": {"type": "string", "foreign_key": "tasks._id"},
        "milestone_id": {"type": "string"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string"},
        "task_type": {"type": "enum", "values": ["story", "task", "bug", "epic", "subtask"], "default": "task"},
        "status": {"type": "enum", "values": ["backlog", "todo", "in_progress", "review", "done", "cancelled"], "default": "todo"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "assignee_id": {"type": "string", "foreign_key": "users._id"},
        "reporter_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "estimated_hours": {"type": "number", "default": 0},
        "actual_hours": {"type": "number", "default": 0},
        "remaining_hours": {"type": "number", "default": 0},
        "story_points": {"type": "integer"},
        "planned_start_date": {"type": "date"},
        "planned_end_date": {"type": "date"},
        "actual_start_date": {"type": "date"},
        "actual_end_date": {"type": "date"},
        "due_date": {"type": "date"},
        "dependencies": {"type": "array", "items": {"type": "string", "foreign_key": "tasks._id"}},
        "blockers": {"type": "array", "items": {"type": "string", "foreign_key": "tasks._id"}},
        "labels": {"type": "array", "items": {"type": "string"}},
        "sprint_id": {"type": "string"},
        "epic_id": {"type": "string", "foreign_key": "tasks._id"},
        "acceptance_criteria": {"type": "string"},
        "custom_fields": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "project_id"]},
        {"fields": ["tenant_id", "assignee_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "due_date"]},
        {"fields": ["parent_task_id"]},
        {"fields": ["created_at"]}
      ]
    },
    "assignments": {
      "description": "Task assignments to users with allocation details",
      "category": "Operations",
      "estimated_size": "Large (50,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "task_id": {"type": "string", "required": true, "foreign_key": "tasks._id"},
        "user_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "role": {"type": "string", "description": "Role in this assignment"},
        "allocation_percentage": {"type": "number", "min": 0, "max": 100},
        "hourly_rate": {"type": "decimal"},
        "start_date": {"type": "date"},
        "end_date": {"type": "date"},
        "status": {"type": "enum", "values": ["assigned", "accepted", "in_progress", "completed", "rejected"], "default": "assigned"},
        "estimated_hours": {"type": "number", "default": 0},
        "actual_hours": {"type": "number", "default": 0},
        "notes": {"type": "string"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "task_id", "user_id"], "unique": true},
        {"fields": ["tenant_id", "user_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["start_date", "end_date"]},
        {"fields": ["created_at"]}
      ]
    },
    "timesheets": {
      "description": "Time tracking entries with approval workflow",
      "category": "Operations",
      "estimated_size": "Very Large (1,000,000s)",
      "growth_rate": "Very High",
      "archival": "Monthly after 13 months",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "user_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "project_id": {"type": "string", "foreign_key": "projects._id"},
        "task_id": {"type": "string", "foreign_key": "tasks._id"},
        "date": {"type": "date", "required": true},
        "start_time": {"type": "time"},
        "end_time": {"type": "time"},
        "hours": {"type": "number", "required": true, "min": 0},
        "overtime_hours": {"type": "number", "default": 0},
        "description": {"type": "string"},
        "activity_type": {"type": "enum", "values": ["development", "testing", "documentation", "meeting", "research", "administration", "other"], "default": "development"},
        "status": {"type": "enum", "values": ["draft", "submitted", "approved", "rejected", "locked"], "default": "draft"},
        "billable": {"type": "boolean", "default": true},
        "hourly_rate": {"type": "decimal"},
        "cost": {"type": "decimal", "description": "Calculated cost"},
        "approver_id": {"type": "string", "foreign_key": "users._id"},
        "approved_at": {"type": "datetime"},
        "approval_notes": {"type": "string"},
        "period_start": {"type": "date"},
        "period_end": {"type": "date"},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "user_id", "date"]},
        {"fields": ["tenant_id", "project_id"]},
        {"fields": ["tenant_id", "task_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "approver_id"]},
        {"fields": ["period_start", "period_end"]},
        {"fields": ["created_at"]}
      ]
    },
    "budgets": {
      "description": "Budget allocations and tracking",
      "category": "Financial",
      "estimated_size": "Medium (5,000s)",
      "growth_rate": "Medium",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "org_id": {"type": "string", "foreign_key": "organizations._id"},
        "portfolio_id": {"type": "string", "foreign_key": "portfolios._id"},
        "project_id": {"type": "string", "foreign_key": "projects._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string"},
        "budget_type": {"type": "enum", "values": ["capex", "opex", "labor", "material", "vendor", "other"], "required": true},
        "status": {"type": "enum", "values": ["draft", "approved", "active", "closed", "cancelled"], "default": "draft"},
        "fiscal_year": {"type": "integer", "required": true},
        "budget_period": {"type": "enum", "values": ["annual", "quarterly", "monthly"], "default": "annual"},
        "currency": {"type": "string", "default": "USD"},
        "total_amount": {"type": "decimal", "required": true},
        "allocated_amount": {"type": "decimal", "default": 0},
        "committed_amount": {"type": "decimal", "default": 0},
        "spent_amount": {"type": "decimal", "default": 0},
        "remaining_amount": {"type": "decimal"},
        "variance_amount": {"type": "decimal"},
        "variance_percentage": {"type": "number"},
        "approval_required": {"type": "boolean", "default": false},
        "approver_id": {"type": "string", "foreign_key": "users._id"},
        "approved_at": {"type": "datetime"},
        "approval_notes": {"type": "string"},
        "budget_manager_id": {"type": "string", "foreign_key": "users._id"},
        "cost_center": {"type": "string"},
        "gl_account": {"type": "string"},
        "start_date": {"type": "date"},
        "end_date": {"type": "date"},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "fiscal_year"]},
        {"fields": ["tenant_id", "project_id"]},
        {"fields": ["tenant_id", "portfolio_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "budget_manager_id"]},
        {"fields": ["cost_center"]},
        {"fields": ["created_at"]}
      ]
    },
    "costs": {
      "description": "Actual cost entries and expense tracking",
      "category": "Financial",
      "estimated_size": "Large (100,000s)",
      "growth_rate": "High",
      "archival": "Quarterly after 2 years",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "budget_id": {"type": "string", "foreign_key": "budgets._id"},
        "project_id": {"type": "string", "foreign_key": "projects._id"},
        "task_id": {"type": "string", "foreign_key": "tasks._id"},
        "user_id": {"type": "string", "foreign_key": "users._id"},
        "timesheet_id": {"type": "string", "foreign_key": "timesheets._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string"},
        "cost_type": {"type": "enum", "values": ["labor", "material", "vendor", "travel", "equipment", "software", "other"], "required": true},
        "cost_category": {"type": "string"},
        "amount": {"type": "decimal", "required": true},
        "currency": {"type": "string", "default": "USD"},
        "quantity": {"type": "number", "default": 1},
        "unit_cost": {"type": "decimal"},
        "unit_type": {"type": "string"},
        "vendor_name": {"type": "string"},
        "invoice_number": {"type": "string"},
        "receipt_url": {"type": "string"},
        "cost_date": {"type": "date", "required": true},
        "period_start": {"type": "date"},
        "period_end": {"type": "date"},
        "status": {"type": "enum", "values": ["draft", "submitted", "approved", "rejected", "paid"], "default": "draft"},
        "approver_id": {"type": "string", "foreign_key": "users._id"},
        "approved_at": {"type": "datetime"},
        "approval_notes": {"type": "string"},
        "billable": {"type": "boolean", "default": false},
        "reimbursable": {"type": "boolean", "default": false},
        "cost_center": {"type": "string"},
        "gl_account": {"type": "string"},
        "purchase_order": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "cost_date"]},
        {"fields": ["tenant_id", "project_id"]},
        {"fields": ["tenant_id", "budget_id"]},
        {"fields": ["tenant_id", "user_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "cost_type"]},
        {"fields": ["cost_center"]},
        {"fields": ["created_at"]}
      ]
    },
    "risks": {
      "description": "Risk and issue management (RAID logs)",
      "category": "Governance",
      "estimated_size": "Large (50,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "portfolio_id": {"type": "string", "foreign_key": "portfolios._id"},
        "project_id": {"type": "string", "foreign_key": "projects._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string", "required": true},
        "risk_type": {"type": "enum", "values": ["risk", "issue", "assumption", "dependency"], "required": true},
        "category": {"type": "enum", "values": ["technical", "business", "operational", "financial", "legal", "resource", "schedule", "quality", "external"], "required": true},
        "status": {"type": "enum", "values": ["open", "in_progress", "closed", "cancelled"], "default": "open"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "medium"},
        "probability": {"type": "enum", "values": ["very_low", "low", "medium", "high", "very_high"]},
        "impact": {"type": "enum", "values": ["very_low", "low", "medium", "high", "very_high"], "required": true},
        "risk_score": {"type": "number"},
        "owner_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "assignee_id": {"type": "string", "foreign_key": "users._id"},
        "identified_date": {"type": "date", "required": true},
        "target_date": {"type": "date"},
        "actual_date": {"type": "date"},
        "mitigation_plan": {"type": "string"},
        "contingency_plan": {"type": "string"},
        "response_strategy": {"type": "enum", "values": ["avoid", "mitigate", "transfer", "accept", "exploit", "enhance", "share"]},
        "cost_impact": {"type": "decimal", "default": 0},
        "schedule_impact_days": {"type": "integer", "default": 0},
        "escalated": {"type": "boolean", "default": false},
        "escalated_to": {"type": "string", "foreign_key": "users._id"},
        "escalated_at": {"type": "datetime"},
        "resolution_notes": {"type": "string"},
        "lessons_learned": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "project_id"]},
        {"fields": ["tenant_id", "portfolio_id"]},
        {"fields": ["tenant_id", "risk_type"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "priority"]},
        {"fields": ["tenant_id", "owner_id"]},
        {"fields": ["tenant_id", "target_date"]},
        {"fields": ["created_at"]}
      ]
    },
    "attachments": {
      "description": "File attachments and document management",
      "category": "Content",
      "estimated_size": "Large (100,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "entity_type": {"type": "enum", "values": ["portfolio", "project", "task", "risk", "timesheet", "cost", "user"], "required": true},
        "entity_id": {"type": "string", "required": true},
        "filename": {"type": "string", "required": true, "max_length": 255},
        "original_filename": {"type": "string", "required": true},
        "file_path": {"type": "string", "required": true},
        "file_size": {"type": "integer", "required": true},
        "mime_type": {"type": "string", "required": true},
        "file_hash": {"type": "string"},
        "version": {"type": "integer", "default": 1},
        "is_latest_version": {"type": "boolean", "default": true},
        "parent_attachment_id": {"type": "string", "foreign_key": "attachments._id"},
        "description": {"type": "string"},
        "category": {"type": "string"},
        "visibility": {"type": "enum", "values": ["private", "team", "project", "portfolio", "public"], "default": "team"},
        "download_count": {"type": "integer", "default": 0},
        "last_accessed": {"type": "datetime"},
        "expires_at": {"type": "datetime"},
        "virus_scanned": {"type": "boolean", "default": false},
        "scan_result": {"type": "enum", "values": ["clean", "infected", "pending"], "default": "pending"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "entity_type", "entity_id"]},
        {"fields": ["tenant_id", "created_by"]},
        {"fields": ["file_hash"]},
        {"fields": ["parent_attachment_id"]},
        {"fields": ["expires_at"]},
        {"fields": ["created_at"]}
      ]
    },
    "audit_logs": {
      "description": "Comprehensive audit trail for compliance",
      "category": "System",
      "estimated_size": "Very Large (10,000,000s)",
      "growth_rate": "Very High",
      "archival": "TTL after 7 years",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "user_id": {"type": "string", "foreign_key": "users._id"},
        "session_id": {"type": "string"},
        "action": {"type": "enum", "values": ["create", "read", "update", "delete", "login", "logout", "export", "import", "approve", "reject"], "required": true},
        "resource_type": {"type": "string", "required": true},
        "resource_id": {"type": "string", "required": true},
        "resource_name": {"type": "string"},
        "old_values": {"type": "object"},
        "new_values": {"type": "object"},
        "changed_fields": {"type": "array", "items": {"type": "string"}},
        "ip_address": {"type": "string"},
        "user_agent": {"type": "string"},
        "request_method": {"type": "string"},
        "request_url": {"type": "string"},
        "response_status": {"type": "integer"},
        "processing_time_ms": {"type": "integer"},
        "risk_level": {"type": "enum", "values": ["low", "medium", "high", "critical"], "default": "low"},
        "success": {"type": "boolean", "default": true},
        "error_message": {"type": "string"},
        "additional_data": {"type": "object"},
        "timestamp": {"type": "datetime", "required": true}
      },
      "indexes": [
        {"fields": ["tenant_id", "timestamp"]},
        {"fields": ["tenant_id", "user_id", "timestamp"]},
        {"fields": ["tenant_id", "action"]},
        {"fields": ["tenant_id", "resource_type", "resource_id"]},
        {"fields": ["tenant_id", "risk_level"]},
        {"fields": ["ip_address"]},
        {"fields": ["timestamp"], "ttl": "7years"}
      ]
    },
    "workflows": {
      "description": "Workflow definitions and approval processes",
      "category": "System",
      "estimated_size": "Small (100s)",
      "growth_rate": "Low",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string"},
        "workflow_type": {"type": "enum", "values": ["approval", "notification", "automation", "escalation"], "required": true},
        "entity_type": {"type": "string", "required": true},
        "trigger_event": {"type": "enum", "values": ["create", "update", "delete", "status_change", "time_based", "manual"], "required": true},
        "trigger_conditions": {"type": "object"},
        "steps": {"type": "array", "items": {"type": "object"}},
        "parallel_execution": {"type": "boolean", "default": false},
        "timeout_hours": {"type": "integer", "default": 24},
        "escalation_rules": {"type": "array", "items": {"type": "object"}},
        "notification_rules": {"type": "array", "items": {"type": "object"}},
        "status": {"type": "enum", "values": ["draft", "active", "inactive", "archived"], "default": "draft"},
        "version": {"type": "integer", "default": 1},
        "is_system_workflow": {"type": "boolean", "default": false},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "entity_type"]},
        {"fields": ["tenant_id", "workflow_type"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["created_at"]}
      ]
    },
    "workflow_instances": {
      "description": "Active workflow executions and state",
      "category": "System",
      "estimated_size": "Large (100,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "workflow_id": {"type": "string", "required": true, "foreign_key": "workflows._id"},
        "entity_type": {"type": "string", "required": true},
        "entity_id": {"type": "string", "required": true},
        "initiated_by": {"type": "string", "required": true, "foreign_key": "users._id"},
        "current_step": {"type": "integer", "default": 0},
        "status": {"type": "enum", "values": ["pending", "in_progress", "completed", "cancelled", "failed", "timeout"], "default": "pending"},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "urgent"], "default": "medium"},
        "due_date": {"type": "datetime"},
        "completed_steps": {"type": "array", "items": {"type": "object"}},
        "pending_approvals": {"type": "array", "items": {"type": "object"}},
        "escalations": {"type": "array", "items": {"type": "object"}},
        "notifications_sent": {"type": "array", "items": {"type": "object"}},
        "data_context": {"type": "object"},
        "error_message": {"type": "string"},
        "completion_notes": {"type": "string"},
        "started_at": {"type": "datetime", "required": true},
        "completed_at": {"type": "datetime"},
        "metadata": {"type": "object"},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true}
      },
      "indexes": [
        {"fields": ["tenant_id", "workflow_id"]},
        {"fields": ["tenant_id", "entity_type", "entity_id"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["tenant_id", "initiated_by"]},
        {"fields": ["due_date"]},
        {"fields": ["started_at"]}
      ]
    },
    "notifications": {
      "description": "System notifications and alerts",
      "category": "System",
      "estimated_size": "Very Large (1,000,000s)",
      "growth_rate": "Very High",
      "archival": "Monthly after 6 months",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "recipient_id": {"type": "string", "required": true, "foreign_key": "users._id"},
        "sender_id": {"type": "string", "foreign_key": "users._id"},
        "notification_type": {"type": "enum", "values": ["system", "workflow", "reminder", "alert", "approval_request", "status_update"], "required": true},
        "title": {"type": "string", "required": true, "max_length": 200},
        "message": {"type": "string", "required": true},
        "priority": {"type": "enum", "values": ["low", "medium", "high", "urgent"], "default": "medium"},
        "category": {"type": "string"},
        "entity_type": {"type": "string"},
        "entity_id": {"type": "string"},
        "action_required": {"type": "boolean", "default": false},
        "action_url": {"type": "string"},
        "channels": {"type": "array", "items": {"type": "string"}},
        "delivery_status": {"type": "object"},
        "read": {"type": "boolean", "default": false},
        "read_at": {"type": "datetime"},
        "expires_at": {"type": "datetime"},
        "metadata": {"type": "object"},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true}
      },
      "indexes": [
        {"fields": ["tenant_id", "recipient_id", "read"]},
        {"fields": ["tenant_id", "notification_type"]},
        {"fields": ["tenant_id", "priority"]},
        {"fields": ["tenant_id", "entity_type", "entity_id"]},
        {"fields": ["expires_at"]},
        {"fields": ["created_at"]}
      ]
    },
    "integrations": {
      "description": "Third-party system integrations",
      "category": "System",
      "estimated_size": "Small (100s)",
      "growth_rate": "Low",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "integration_type": {"type": "enum", "values": ["sso", "scim", "webhook", "api", "file_sync", "email", "calendar"], "required": true},
        "provider": {"type": "string", "required": true},
        "status": {"type": "enum", "values": ["draft", "active", "inactive", "error"], "default": "draft"},
        "configuration": {"type": "object"},
        "credentials": {"type": "object"},
        "sync_enabled": {"type": "boolean", "default": false},
        "sync_frequency": {"type": "string"},
        "last_sync_at": {"type": "datetime"},
        "last_sync_status": {"type": "enum", "values": ["success", "error", "partial"]},
        "last_sync_message": {"type": "string"},
        "error_count": {"type": "integer", "default": 0},
        "webhook_url": {"type": "string"},
        "webhook_secret": {"type": "string"},
        "supported_events": {"type": "array", "items": {"type": "string"}},
        "field_mapping": {"type": "object"},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "integration_type"]},
        {"fields": ["tenant_id", "provider"]},
        {"fields": ["tenant_id", "status"]},
        {"fields": ["webhook_url"]},
        {"fields": ["created_at"]}
      ]
    },
    "reports": {
      "description": "Custom reports and dashboard definitions",
      "category": "Analytics",
      "estimated_size": "Medium (5,000s)",
      "growth_rate": "Medium",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "name": {"type": "string", "required": true, "max_length": 200},
        "description": {"type": "string"},
        "report_type": {"type": "enum", "values": ["dashboard", "report", "chart", "table", "export"], "required": true},
        "category": {"type": "string"},
        "data_source": {"type": "string"},
        "query_definition": {"type": "object"},
        "visualization_config": {"type": "object"},
        "parameters": {"type": "array", "items": {"type": "object"}},
        "schedule": {"type": "object"},
        "output_format": {"type": "array", "items": {"type": "string"}},
        "access_level": {"type": "enum", "values": ["private", "team", "department", "organization", "tenant"], "default": "private"},
        "shared_with": {"type": "array", "items": {"type": "string", "foreign_key": "users._id"}},
        "is_system_report": {"type": "boolean", "default": false},
        "is_template": {"type": "boolean", "default": false},
        "usage_count": {"type": "integer", "default": 0},
        "last_generated": {"type": "datetime"},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "report_type"]},
        {"fields": ["tenant_id", "created_by"]},
        {"fields": ["tenant_id", "category"]},
        {"fields": ["tenant_id", "is_system_report"]},
        {"fields": ["created_at"]}
      ]
    },
    "dashboard_widgets": {
      "description": "Dashboard widget instances and configurations",
      "category": "Analytics",
      "estimated_size": "Large (50,000s)",
      "growth_rate": "High",
      "fields": {
        "_id": {"type": "string", "primary_key": true},
        "tenant_id": {"type": "string", "required": true, "foreign_key": "tenants._id"},
        "dashboard_id": {"type": "string", "foreign_key": "reports._id"},
        "user_id": {"type": "string", "foreign_key": "users._id"},
        "widget_type": {"type": "enum", "values": ["chart", "table", "metric", "list", "calendar", "custom"], "required": true},
        "title": {"type": "string", "required": true, "max_length": 200},
        "position": {"type": "object"},
        "data_source": {"type": "string", "required": true},
        "query_config": {"type": "object"},
        "visualization_config": {"type": "object"},
        "refresh_interval": {"type": "integer"},
        "cache_duration": {"type": "integer"},
        "filters": {"type": "object"},
        "drill_down_config": {"type": "object"},
        "permissions": {"type": "array", "items": {"type": "string"}},
        "last_updated": {"type": "datetime"},
        "metadata": {"type": "object"},
        "is_active": {"type": "boolean", "default": true},
        "created_at": {"type": "datetime", "required": true},
        "updated_at": {"type": "datetime", "required": true},
        "created_by": {"type": "string", "foreign_key": "users._id"},
        "updated_by": {"type": "string", "foreign_key": "users._id"}
      },
      "indexes": [
        {"fields": ["tenant_id", "dashboard_id"]},
        {"fields": ["tenant_id", "user_id"]},
        {"fields": ["tenant_id", "widget_type"]},
        {"fields": ["created_at"]}
      ]
    }
  },
  "relationships": {
    "tenant_to_organizations": {
      "type": "one_to_many",
      "parent": "tenants",
      "child": "organizations",
      "description": "Tenants contain organizational units"
    },
    "tenant_to_users": {
      "type": "one_to_many", 
      "parent": "tenants",
      "child": "users",
      "description": "Tenants have users"
    },
    "organization_hierarchy": {
      "type": "self_referential",
      "table": "organizations",
      "parent_field": "parent_org_id",
      "description": "Organizations can have parent-child relationships"
    },
    "organization_to_users": {
      "type": "one_to_many",
      "parent": "organizations", 
      "child": "users",
      "description": "Organizations contain users"
    },
    "organization_to_portfolios": {
      "type": "one_to_many",
      "parent": "organizations",
      "child": "portfolios", 
      "description": "Organizations manage portfolios"
    },
    "portfolio_to_projects": {
      "type": "one_to_many",
      "parent": "portfolios",
      "child": "projects",
      "description": "Portfolios contain projects"
    },
    "project_hierarchy": {
      "type": "self_referential", 
      "table": "projects",
      "parent_field": "parent_project_id",
      "description": "Projects can have sub-projects"
    },
    "project_to_tasks": {
      "type": "one_to_many",
      "parent": "projects",
      "child": "tasks",
      "description": "Projects contain tasks"
    },
    "task_hierarchy": {
      "type": "self_referential",
      "table": "tasks", 
      "parent_field": "parent_task_id",
      "description": "Tasks can have subtasks"
    },
    "task_to_assignments": {
      "type": "one_to_many",
      "parent": "tasks",
      "child": "assignments",
      "description": "Tasks are assigned to users"
    },
    "user_to_assignments": {
      "type": "one_to_many", 
      "parent": "users",
      "child": "assignments",
      "description": "Users receive task assignments"
    },
    "user_to_timesheets": {
      "type": "one_to_many",
      "parent": "users",
      "child": "timesheets", 
      "description": "Users log time on timesheets"
    },
    "project_to_timesheets": {
      "type": "one_to_many",
      "parent": "projects",
      "child": "timesheets",
      "description": "Time is logged against projects"
    },
    "task_to_timesheets": {
      "type": "one_to_many",
      "parent": "tasks",
      "child": "timesheets",
      "description": "Time is logged against tasks"
    },
    "project_to_budgets": {
      "type": "one_to_many", 
      "parent": "projects",
      "child": "budgets",
      "description": "Projects have budgets"
    },
    "portfolio_to_budgets": {
      "type": "one_to_many",
      "parent": "portfolios",
      "child": "budgets",
      "description": "Portfolios have budgets"
    },
    "budget_to_costs": {
      "type": "one_to_many",
      "parent": "budgets",
      "child": "costs",
      "description": "Budgets track costs"
    },
    "project_to_costs": {
      "type": "one_to_many",
      "parent": "projects", 
      "child": "costs",
      "description": "Projects incur costs"
    },
    "timesheet_to_costs": {
      "type": "one_to_one",
      "parent": "timesheets",
      "child": "costs",
      "description": "Labor costs from timesheets"
    },
    "project_to_risks": {
      "type": "one_to_many",
      "parent": "projects",
      "child": "risks",
      "description": "Projects have risks"
    },
    "portfolio_to_risks": {
      "type": "one_to_many",
      "parent": "portfolios",
      "child": "risks", 
      "description": "Portfolios have risks"
    },
    "attachment_versioning": {
      "type": "self_referential",
      "table": "attachments",
      "parent_field": "parent_attachment_id",
      "description": "File version management"
    },
    "user_management_hierarchy": {
      "type": "self_referential",
      "table": "users", 
      "parent_field": "manager_id",
      "description": "User reporting structure"
    },
    "workflow_to_instances": {
      "type": "one_to_many",
      "parent": "workflows",
      "child": "workflow_instances",
      "description": "Workflow definitions create instances"
    },
    "user_to_notifications": {
      "type": "one_to_many",
      "parent": "users",
      "child": "notifications",
      "description": "Users receive notifications"
    },
    "tenant_to_integrations": {
      "type": "one_to_many",
      "parent": "tenants", 
      "child": "integrations",
      "description": "Tenants configure integrations"
    },
    "user_to_reports": {
      "type": "one_to_many",
      "parent": "users",
      "child": "reports",
      "description": "Users create reports"
    },
    "report_to_widgets": {
      "type": "one_to_many",
      "parent": "reports",
      "child": "dashboard_widgets",
      "description": "Reports contain widgets"
    }
  },
  "database_optimization": {
    "sharding_strategy": {
      "shard_key": {"tenant_id": 1, "created_at": 1},
      "rationale": "Tenant isolation with temporal distribution",
      "sharded_collections": ["timesheets", "audit_logs", "tasks", "costs", "notifications"]
    },
    "archival_strategy": {
      "timesheets": "Monthly after 13 months retention",
      "audit_logs": "TTL after 7 years for compliance",
      "tasks": "Archived after 3 years to cold storage", 
      "costs": "Quarterly archival after 2 years",
      "notifications": "Monthly archival after 6 months"
    },
    "indexing_priorities": {
      "priority_1": "Tenant isolation, authentication, task management",
      "priority_2": "Reporting, search, analytics",
      "priority_3": "Administration, integrations"
    },
    "performance_targets": {
      "query_response_time": "<100ms average",
      "throughput": ">5000 operations/second per shard", 
      "concurrent_users": "10000+ per tenant",
      "availability": "99.9% uptime"
    }
  }
}